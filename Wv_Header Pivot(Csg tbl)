DECLARE @query_district VARCHAR(50) = 'Utica';
DECLARE @query_Date Date = '2011-01-01';
DECLARE @query_division VARCHAR(50) = '';
DECLARE @query_pn VARCHAR(50) = '';
DECLARE @query_county VARCHAR(50) = '';
DECLARE @query_wellname VARCHAR(50) = '';

SELECT 
	idwell as [idwell],
	[wellname] as [Well Name],
	[wellidc] as [PN],
	[district] as [District],
	[division] as [Division] ,
	[county] as [County],
	[dttmspud] as [Spud date],
	[dttmrr] as [Rig Release date],
	Round([Conductor],0) as [Cond Set Md],
	Round([Planned Surface],0) as [Surf Csg Set Md-Pln],
	Round([Surface],0) as [Surf Csg Set Md] ,
	Round([Planned Intermediate],0) as [Int Csg Set Md-Pln],
	Round([Intermediate] ,0)as [Int Csg Set Md],
	Round([Planned Production],0) as [Prod Csg Set Md-Pln],
	Round([Production],0) as [Prod Csg Set Md]

FROM
		(SELECT
			wh.idwell,
			wh.wellidc ,
			wh.wellname ,
			wh.district ,
			wh.division ,
			wh.county ,
			wh.latitude,
			wh.longitude,
			wh.dttmspud,
			wh.dttmrr,
			csg.des,
			csg.depthbtm * 3.28084 as [Depth]

		FROM dbo.wvt_wvwellheader wh

		Join dbo.wvt_wvcas csg on wh.idwell=csg.idwell					-- join csg table
		join [dbo].[wvt_wvJobDrillBit] bit on wh.idwell=bit.idwell		-- join bit table
	

		WHERE wh.dttmspud >= @query_Date

		) AS csgPivot

		PIVOT
		(	--Pivot table on columns
			MAX(csgPivot.Depth)
			For csgPivot.des IN ([Conductor],
						[Planned Surface],
						[Surface],
						[Planned Intermediate],
						[Intermediate],
						[Planned Production],
						[Production]
						
						)
		) AS Pvt1

GROUP BY 
	Pvt1.idwell,
	Pvt1.[wellname],
	Pvt1.[wellidc],
	Pvt1.[dttmspud],
	Pvt1.[dttmrr],
	Pvt1.[latitude],
	Pvt1.[longitude],
	Pvt1.[district],
	Pvt1.[division],
	Pvt1.[county],
	Pvt1.[Conductor], 
	Pvt1.[Planned Surface],
	Pvt1.[Surface],
	Pvt1.[Planned Intermediate],
	Pvt1.[Intermediate],
	Pvt1.[Planned Production],
	Pvt1.[Production]

Order By [district],[Well Name]
